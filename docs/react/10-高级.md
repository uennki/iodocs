# 高级

## React.lazy（懒加载）

作用：按需引入所用组件，减少组件加载时间。

```jsx
const OtherComponent = React.lazy(() => import('./OtherComponent'));

function MyComponent() {
  return (
    <div>
      <OtherComponent />
    </div>
  );
}
```

## Suspense （加载指示器组件）

作用：组件加载过程中的提示。

```jsx
const OtherComponent = React.lazy(() => import('./OtherComponent'));

function MyComponent() {
  return (
    <div>
      <Suspense fallback={<div>Loading...</div>}>
        <OtherComponent />
      </Suspense>
    </div>
  );
}
```

## Context（依赖注入）

作用：跨层级进行组件间的数据传递。

```jsx
const ThemeContext = React.createContext('light');

class App extends React.Component {
  render() {
    // 使用一个 Provider 来将当前的 theme 传递给以下的组件树。
    // 无论多深，任何组件都能读取这个值。
    // 在这个例子中，我们将 “dark” 作为当前的值传递下去。
    return (
      <ThemeContext.Provider value="dark">
        <Toolbar />
      </ThemeContext.Provider>
    );
  }
}
```

## Refs （DOM操作）

作用：获取组件的 DOM 进行所需要的相关操作。（仅类组件支持ref）

它有以下三种获取方式：

第一种：赋值型（通用型）

```jsx
class App extends Component {
  constructor(props) {
    super(props)
    this.textInput = React.createRef();
  }

  handleClick = ()=>{
    console.log(this.textInput.current);
  }
  
  render() {
    return (
      <div>
        <h1 ref={this.textInput} onClick={this.handleClick}>
          hello
        </h1>
      </div>
    )
  }
}
```

第二种：回调型

```jsx
class App extends Component {
  handleClick = () => {
    console.log(this.textInput);
  }

  render() {
    return (
      <div>
        <h1 ref={el => this.textInput = el} onClick={this.handleClick} >
          hello
        </h1>
      </div>
    )
  }
}
```

第三种：API型

```jsx
// 作用：获取子组件内部某一 DOM 节点
const FancyButton = React.forwardRef((props, ref) => (
  <button ref={ref} className="FancyButton">
    {props.children}
  </button>
));

// 可以直接获取 DOM button 的 ref：
const ref = React.createRef();
<FancyButton ref={ref}>Click me!</FancyButton>;
```

## Fragments （多元素组件）

作用：多组件的容器。

```jsx
render() {
  return (
    <React.Fragment>
      <ChildA />
      <ChildB />
      <ChildC />
    </React.Fragment>
  );
}
```

## Portals （类插槽）

作用：将子节点渲染到存在于父组件以外的 DOM 节点

```jsx
render() {
  // 并没有创建一个新的元素
  // 它只是把当前元素渲染到 domNode 中
  // domNode 是一个可以在任何位置的有效 DOM 节点
  return ReactDOM.createPortal(
    this.props.children,
    domNode
  );
}
```
