# 路由

## 基础

在 react-router-dom 中，路由组件大体可以分为3种：

- 路由组件
  - BrowserRouter
  - HashRouter
  - MemoryRouter
  - StaticRouter
  - withRouter
- 路由匹配组件
  - Route
  - Switch
  - Redirect
- 导航组件
  - Link
  - NavLink

每个组件的功能都不一样，组件还有各自的属性参数，以下内容只是个人学习过程中概述，更具体的可以参考[官方文档](https://reacttraining.com/react-router/web/api/BrowserRouter)

## 起步

首先来看路由的一个基本使用范例，它由最基本的3个路由核心组件组成。

- 特点：
  - Router 组件：路由容器，所有的路由必须在其内
  - Route 组件：单个路由
  - Link 组件：路由指针

```jsx
import React from "react";
import { BrowserRouter as Router, Route, Link } from "react-router-dom";

function Home() {
  return (
    <div>
      <h2>Home</h2>
    </div>
  );
}

function About() {
  return (
    <div>
      <h2>About</h2>
    </div>
  );
}

function BasicExample() {
  return (
    <Router>
      <div>
        <ul>
          <li> <Link to="/">Home</Link> </li>
          <li> <Link to="/about">About</Link> </li>
        </ul>

        <Route exact path="/" component={Home} />
        <Route path="/about" component={About} />
      </div>
    </Router>
  );
}

export default BasicExample;
```

## 动态路由匹配

我们经常需要把某种模式匹配到的所有路由，全都映射到同个组件。例如，我们有一个 User 组件，对于所有 ID 各不相同的用户，都要使用这个组件来渲染。那么，我们可以在 react-router 的路由路径中使用“动态路径参数”(dynamic segment) 来达到这个效果：

```jsx
function Child(props) {
  // 当使用路由时，在路由渲染的组件的 `props` 属性上，
  // 会有一个 `match` 属性，
  // 里面包含了此路由的相关信息。
  const {match} = props
  
  return (
    <h1>id: {match.params.id}</h1>
  )
}

function BasicExample() {
  return (
    <Router>
      <div>
        <ul>
          <li> <Link to="/home">Home</Link> </li>
          <li> <Link to="/about">About</Link> </li>
        </ul>

        {/* 动态路径参数 */}
        <Route path="/:id" component={Child}></Route>
      </div>
    </Router>
  );
}
```

<!-- ### 嵌套路由 -->

<!-- ### 编程式的导航 -->

<!-- ### 路由重定向 -->

## 路由组件传参

路由组件传参大体有4种方式：

- params
- query
- state
- search

这里主要记录前两种常用的方式。

### params

- 特点：
  - 刷新地址栏，参数依然存在
  - 只能传字符串，并且，如果传的值太多的话，url会变得长而丑陋

```jsx
function BasicExample() {
  return (
    <Router>
      <div>
        <ul>
          {/*
            编程式跳转：
            this.props.history.push({
              pathname:"/path/" + name
            });
          */}
          <li> <link to="/path/2">xxx</Link></li>
        </ul>

        {/* 读取参数用：this.props.match.params.name*/}
        <Route path='/path/:name' component={Path}/>
      </div>
    </Router>
  );
}
```

### query

- 特点：
  - 传参优雅，传递参数可传对象
  - 刷新地址栏，参数丢失

```jsx
function BasicExample() {
  return (
    <Router>
      <div>
        <ul>
          {/*
            编程式跳转：
            this.props.history.push({
              pathname:"/query",
              query: { name : 'sunny' }
            });
          */}
          <li><Link to={{ path : ' /query' , query : { name : 'sunny' }}}></li>
        </ul>

        {/* 读取参数用: this.props.location.query.name*/}
        <Route path='/query' component={Query}/>
      </div>
    </Router>
  );
}
```
