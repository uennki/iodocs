# 网络

## UDP 和 TCP

OSI 和 TCP/IP 模型在传输层定义两种传输协议：TCP（传输控制协议）和 UDP（用户数据报协议）。

### UDP

UDP（用户数据报协议）是一种 **无连接** 的传输层协议，提供面向报文的简单 **不可靠** 信息传送服务。

它的主要特点是：

- 无连接的。也就是说通信不需要建立和断开连接。
- 不可靠的。协议收到什么数据就传递什么数据，并且也不会备份数据，对方能不能收到是不关心的。（可能丢包）
- 没有拥塞控制。一直会以恒定的速度发送数据。因此网络出现拥塞不会使源主机的发送速率降低（对实时应用很有用，如IP电话，实时视频会议等）
- 支持一对一，多对一，多对多的交互通信

### TCP

TCP（传输控制协议）是一种 **面向连接** 的、**可靠的**、基于字节流的传输层通信协议。

它的主要特点是：

- 面向连接的。正式通信前必须要与对方建立连接。类似像打电话，必须先打通电话再进行后续沟通。
- 可靠的数据服务。协议传送的数据，无差错，不丢失，不重复，且按序到达。
- 连接只能是点到点的通信。

### 区别

关于 TCP 和 UDP 的区别其实在上面各自的特点上已经有所描述，这里简单列个表格：

/ | TCP | UDP
--|-----|----
连接性 | 面向连接 | 无连接 | 
可靠性 | 传送的数据，无差错，不丢失，不重复，且按序到达 | 不可靠（可能丢包）
拥塞控制 | 有 | 没有 | 
传输速度 | 慢 | 快 | 
头部大小 | 需要 20 字节 | 只要 8 个字节 | 
应用场景 | 传输大量的数据 | 少量数据

## HTTP

HTTP 是一个快速灵活，**无连接**，**无状态** 的协议。

> 在 HTTP 的基础上，还有一个更加可靠安全的传输信息方式 —— HTTPS。 它和 HTTP 的主要区别在于，HTTPS 将信息通过 TLS 协议进行加密传输。（TLS 协议位于传输层之上，应用层之下）

### POST 和 GET 的区别

在实际的开发过程中，我们最常接触的两个方法就是 POST 和 GET 。

从技术上来说：

- GET 请求会被浏览器缓存，POST 不会。
- GET 比 POST 更不安全，因为参数直接暴露在 URL 上，且会被浏览器保存在历史记录中。（实际 POST 也不绝对安全，抓包情况下都一样）
- GET 参数通过 URL 传递，POST 参数放在 Request body 中。
- GET 请求在 URL 中的参数有长度限制（受浏览器因素影响），POST 没有长度限制。
- GET 只能进行 URL 编码，POST 支持多种编码方式且不对数据类型限制。

### 常见状态码

#### 2XX 成功

- 200 OK：表示从客户端发来的请求在服务器端被正确处理
- 204 No content：表示请求成功，但响应报文不含实体的主体部分
- 205 Reset Content：表示请求成功，但响应报文不含实体的主体部分，但是与 204 响应不同在于要求请求方重置内容
- 206 Partial Content：进行范围请求

#### 3XX 重定向

- 301 moved permanently：永久性重定向，表示资源已被分配了新的 URL
- 302 found：临时性重定向，表示资源临时被分配了新的 URL
- 303 see other：表示资源存在着另一个 URL，应使用 GET 方法获取资源
- 304 not modified：表示服务器允许访问资源，但因发生请求未满足条件的情况
- 307 temporary redirect：临时重定向，和302含义类似，但是期望客户端保持请求方法不变向新的地址发出请求

#### 4XX 客户端错误

- 400 bad request：请求报文存在语法错误
- 401 unauthorized：表示发送的请求需要有通过 HTTP 认证的认证信息
- 403 forbidden：表示对请求资源的访问被服务器拒绝
- 404 not found：表示在服务器上没有找到请求的资源

#### 5XX 服务端错误

- 500 internal sever error：表示服务器端在执行请求时发生了错误
- 501 Not Implemented：表示服务器不支持当前请求所需要的某个功能
- 503 service unavailable：表明服务器暂时处于超负载或正在停机维护，无法处理请求

### HTTP 常见方法

以下是 HTTP 请求的常见方法一览：

方法 | 作用
---|---
GET | 获取资源
POST | 传输资源
PUT | 更新资源
DELETE | 删除资源
HEAD | 获得报文首部

### HTTP 首部

通用字段 | 作用 |  | 实体字段 | 作用
-----|----|--|------|---
Cache-Control | 控制缓存的行为 |  | Allow | 资源的正确请求方式
Connection | 浏览器想要优先使用的连接类型，比如 keep-alive |  | Content-Encoding | 内容的编码格式
Date | 创建报文时间 |  | Content-Language | 内容使用的语言
Pragma | 报文指令 |  | Content-Length | request body 长度
Via | 代理服务器相关信息 |  | Content-Location | 返回数据的备用地址
Transfer-Encoding | 传输编码方式 |  | Content-MD5 | Base64加密格式的内容 MD5检验值
Upgrade | 要求客户端升级协议 |  | Content-Range | 内容的位置范围
Warning | 在内容中可能存在错误 |  | Content-Type | 内容的媒体类型
/ | / |  | Expires | 内容的过期时间
/ | / |  | Last_modified | 内容的最后修改时间

请求字段 | 作用 |  | 响应字段 | 作用
-----|----|--|------|---
Accept | 能正确接收的媒体类型 |  | Accept-Ranges | 是否支持某些种类的范围
Accept-Charset | 能正确接收的字符集 |  | Age | 资源在代理缓存中存在的时间
Accept-Encoding | 能正确接收的编码格式列表 |  | ETag | 资源标识
Accept-Language | 能正确接收的语言列表 |  | Location | 客户端重定向到某个 URL
Expect | 期待服务端的指定行为 |  | Proxy-Authenticate | 向代理服务器发送验证信息
From | 请求方邮箱地址 |  | Server | 服务器名字
Host | 服务器的域名 |  | WWW-Authenticate | 获取资源需要的验证信息
If-Match | 两端资源标记比较 |  | / | /
If-Modified-Since | 本地资源未修改返回 304（比较时间） |  | / | /
If-None-Match | 本地资源未修改返回 304（比较标记） |  | / | /
User-Agent | 客户端信息 |  | / | /
Max-Forwards | 限制可被代理及网关转发的次数 |  | / | /
Proxy-Authorization | 向代理服务器发送验证信息 |  | / | /
Range | 请求某个内容的一部分 |  | / | /
Referer | 表示浏览器所访问的前一个页面 |  | / | /
TE | 传输编码方式 |  | / | /

## 从输入 URL 到页面加载完成的过程

这里简单整理下，具体每个过程详细的步骤，大家可以去网上具体查阅：

1. DNS 解析域名，获取 IP 地址
2. TCP 连接（TCP三次握手，防止已失效的连接请求报文段突然又传送到了服务端，因而产生错误）
3. 确认连接成功后，发送 HTTP 请求
4. 服务器处理请求，并返回 HTTP 报文
5. 浏览器解析文件，开始渲染页面
6. 连接结束，关闭连接（TCP四次挥手）
